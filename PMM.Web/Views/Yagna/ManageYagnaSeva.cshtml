@model YagnaSevaModel
@using PMM.Web.Models.Yagna;
@using PMM.Core;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<div class="">
    <div class="page-title">
        <div class="title_left">
            <h3>
                MANAGE YAJMAN
            </h3>
        </div>
    </div>


    <div class="row">
        <div class="col-md-12">
            @using (Html.BeginRouteForm("ManageYagnaSeva", FormMethod.Post, new { @id = "sevaForm" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(t => t.Id)
                @Html.HiddenFor(t => t.Karyakar.Id)
                @Html.HiddenFor(t => t.PRN)
                @Html.HiddenFor(t => t.IsContinue)
                @Html.HiddenFor(t => t.Yajmans.Id)
                @Html.HiddenFor(t => t.AccountDetail.Id)
                @Html.HiddenFor(t => t.TransactionDetail.Id)
                <div class="x_panel">
                    <div class="x_content">
                        <div class="col-md-12 ">
                            <span class="section">
                                Yajman Detail
                            </span>
                            <div class="clearfix"></div>
                        </div>
                        <div class="col-md-12 ">
                            <div class="col-md-3 pt10">
                                <label for="FirstName">FirstName</label>
                                @Html.TextBoxFor(t => t.Yajmans.FirstName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForFirstName })
                                @Html.ValidationMessageFor(t => t.Yajmans.FirstName)

                            </div>
                            <div class="col-md-3 pt10">
                                <label for="MiddleName">FatherName</label>
                                @Html.TextBoxFor(t => t.Yajmans.MiddleName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForMiddleName })
                            </div>
                            <div class="col-md-3 pt10">
                                <label for="LastName">SurName</label>
                                @Html.TextBoxFor(t => t.Yajmans.LastName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForLastName })
                                @Html.ValidationMessageFor(t => t.Yajmans.LastName)
                            </div>
                            <div class="col-md-3 pt10">
                                <label for="Mobile">Mobile</label>
                                @Html.TextBoxFor(t => t.Yajmans.Mobile, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForMobileNo, @maxlength = 15, onkeypress = "return isNumberkey(event);" })
                                @Html.ValidationMessageFor(t => t.Yajmans.Mobile)
                            </div>
                        </div>
                        <div class="col-md-12">

                            <div class="col-md-3 pt10">
                                <label for="CityId">City</label>
                                @Html.DropDownListFor(t => t.Yajmans.CityId, Model.Yajmans.CityList, new { @class = "chzn-select form-control", placeholder = CommonHelper.PlaceHolderDrdForCity })
                                @Html.ValidationMessageFor(t => t.Yajmans.CityId)

                            </div>
                            <div class="col-md-3 pt10">
                                <label for="MandalId">Mandal</label>
                                @Html.DropDownListFor(t => t.Yajmans.MandalId, Model.Yajmans.Mandals, new { @class = "chzn-select form-control", placeholder = CommonHelper.PlaceHolderDrdForMandal })
                                @Html.ValidationMessageFor(t => t.Yajmans.MandalId)
                            </div>
                            <div class="col-md-3 pt10">
                                <label for="Address">Address</label>
                                @Html.TextAreaFor(t => t.Yajmans.Address, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForAddress })
                                @Html.ValidationMessageFor(t => t.Yajmans.Address)


                            </div>
                            <div class="col-md-3 pt10">
                                <label for="PinCode">PinCode</label>
                                @Html.TextBoxFor(t => t.Yajmans.PinCode, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForPinCode, @maxlength = 6, onkeypress = "return isNumberkey(event);" })
                                @*@Html.ValidationMessageFor(t => t.Yajmans.PinCode)*@
                            </div>

                        </div>

                        <div class="col-md-12">                            
                            <div class="col-md-3 pt10">
                                <label for="SeatingReqYajmanId">Seating With Yajman</label>
                                @Html.TextBoxFor(t => t.SeatingReqYajmanId, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForPRNNo })
                                <a href="@Url.RouteUrl("Yagna")" class="blue-color" target="_blank">Don't know ID</a>
                            </div>
                            <div class="col-md-3 pt10">
                                <label for="AvailableForYagna">AvailableForYagna</label>
                                @Html.CheckBoxFor(t => t.AvailableForYagna, new { @class = "form-control icheckbox_flat -green" })

                            </div>
                            <div class="col-md-3 pt10">
                                <label for="AvailableForYagna">IsChairRequired</label>
                                @Html.CheckBoxFor(t => t.IsChairRequired, new { @class = "form-control icheckbox_flat -green" })
                            </div>
                            <div class="col-md-3 pt10">
                            </div>
                        </div>
                        <div class="col-md-12 pt10">
                            <span class="section">Seva Detail</span>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-4 pt10">
                                <label for="Amount">Sankalp Amount</label>
                                @Html.TextBoxFor(t => t.SankalpAmount, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderDrdForSankalpAmount, @maxlength = 8, onkeypress = "return isNumberkey(event);" })
                                @Html.ValidationMessageFor(t => t.SankalpAmount)
                            </div>
                            <div class="col-md-4 pt10">
                                <label for="AccountDetail_PaidAmount">Paid Amount</label>
                                @Html.TextBoxFor(t => t.AccountDetail.PaidAmount, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderDrdForSankalpAmount, @maxlength = 8, onkeypress = "return isNumberkey(event);" })
                                @Html.ValidationMessageFor(t => t.AccountDetail.PaidAmount)
                            </div>
                            <div class="col-md-4 pt10">
                                <label for="SevaGradeId">Seva Grade</label>
                                @Html.DropDownListFor(t => t.SevaGradeId, Model.SevaGrades, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderDrdForSevaGrade })
                                @Html.ValidationMessageFor(t => t.SevaGradeId)
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-4 pt10">
                                <label for="DueAmount">Due Amount</label>
                                @Html.TextBoxFor(t => t.AccountDetail.DueAmount, new { @class = "form-control", placeholder = "0", @maxlength = 8, onkeypress = "return isNumberkey(event);", @readonly = "readonly" })


                            </div>
                            <div class="col-md-4 pt10">
                                <label for="Remarks">Remarks</label>
                                @Html.TextAreaFor(t => t.Remarks, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderDrdForRemarks })
                            </div>
                            <div class="col-md-4 pt10"></div>
                        </div>

                        <div id="pnlAccount">
                            <div class="col-md-12 pt10">
                                <span class="section">Account Detail</span>
                            </div>
                            <div class="col-md-12 pt10">
                                <div class="col-md-4 pt10">
                                    <label for="AccountDetail_BookNo">BookNo</label>
                                    @Html.TextBoxFor(t => t.AccountDetail.BookNo, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForBookNo, @maxlength = 5, onkeypress = "return isNumberkey(event);" })
                                    @Html.ValidationMessageFor(t => t.AccountDetail.BookNo)
                                </div>
                                <div class="col-md-4 pt10">
                                    <label for="AccountDetail_ReceiptNo">ReceiptNo</label>
                                    @Html.TextBoxFor(t => t.AccountDetail.ReceiptNo, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForReceiptNo, @maxlength = 5, onkeypress = "return isNumberkey(event);" })
                                    @Html.ValidationMessageFor(t => t.AccountDetail.ReceiptNo)
                                </div>
                                <div class="col-md-4 pt10">
                                    <label for="AccountDetail_DateOfReceipt">Date Of Receipt</label>
                                    @Html.TextBoxFor(t => t.AccountDetail.DateOfReceipt, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForDateOfReceipt })
                                    @Html.ValidationMessageFor(t => t.AccountDetail.DateOfReceipt)
                                </div>
                            </div>

                            <div class="col-md-12 pt10">
                                <span class="section">Transaction Detail</span>
                            </div>
                            <div class="col-md-12 ">
                                <div class="col-md-3 pt10">
                                    <label for="TransactionDetail_TransactionTypeId">Transaction Type</label>
                                    @Html.DropDownListFor(t => t.TransactionDetail.TransactionTypeId, Model.TransactionDetail.TransactionTypes, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderDrdForTransactionType })
                                    @Html.ValidationMessageFor(t => t.TransactionDetail.TransactionTypeId)
                                </div>
                                <div class="col-md-3 pt10">
                                    <label for="TransactionDetail_TransactionNumber" id="lblTransNo">Number</label>
                                    @Html.TextBoxFor(t => t.TransactionDetail.TransactionNumber, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForTransactionNumber, @maxlength = 10, onkeypress = "return isNumberkey(event);" })
                                    @Html.ValidationMessageFor(t => t.TransactionDetail.TransactionNumber)
                                </div>

                                <div class="col-md-3 pt10">
                                    <label for="TransactionDetail_DateOfIssue">Date Of Issue</label>
                                    @Html.TextBoxFor(t => t.TransactionDetail.DateOfIssue, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForDateOfIssue })
                                    @*@Html.ValidationMessageFor(t => t.TransactionDetail.DateOfIssue)*@
                                </div>
                                <div class="col-md-3 pt10">
                                    <label for="TransactionDetail_BankName">Bank Name</label>
                                    @Html.TextBoxFor(t => t.TransactionDetail.BankName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForBankName })
                                    @Html.ValidationMessageFor(t => t.TransactionDetail.BankName)
                                </div>
                            </div>
                        </div>



                        <div class="col-md-12 pt10">
                            <span class="section">Karyakar Detail</span>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-4 pt10">
                                <label for="Karyakar_Mobile">Mobile</label>
                                @Html.TextBoxFor(t => t.Karyakar.Mobile, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForMobileNo, @maxlength = 15, onkeypress = "return isNumberkey(event);" })
                                @Html.ValidationMessageFor(t => t.Karyakar.Mobile)
                            </div>
                            <div class="col-md-4 pt10">
                                <label for="SvikrutiPatrakDetail.ReceiptNo">Form No</label>
                                @Html.TextBoxFor(t => t.SvikrutiPatrakDetail.FormNo, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForFormtNo, @maxlength = 10 })
                                @Html.ValidationMessageFor(t => t.SvikrutiPatrakDetail.FormNo)
                            </div>
                            <div class="col-md-4 pt10">

                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-4 pt10">
                                <label for="Karyakar_FirstName">FirstName</label>
                                @Html.TextBoxFor(t => t.Karyakar.FirstName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForFirstName })
                                @Html.ValidationMessageFor(t => t.Karyakar.FirstName)
                            </div>
                            <div class="col-md-4 pt10">
                                <label for="Karyakar_MiddleName">MiddleName</label>
                                @Html.TextBoxFor(t => t.Karyakar.MiddleName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForMiddleName })
                            </div>
                            <div class="col-md-4 pt10">
                                <label for="Karyakar_LastName">LastName</label>
                                @Html.TextBoxFor(t => t.Karyakar.LastName, new { @class = "form-control", placeholder = CommonHelper.PlaceHolderTxtForLastName })
                                @Html.ValidationMessageFor(t => t.Karyakar.LastName)
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-4 pt10">
                                <label for="Karyakar_CityId">City</label>
                                @Html.DropDownListFor(t => t.Karyakar.CityId, Model.Karyakar.CityList, new { @class = "chzn-select form-control", placeholder = CommonHelper.PlaceHolderDrdForCity })
                                @Html.ValidationMessageFor(t => t.Karyakar.CityId)
                            </div>
                            <div class="col-md-4 pt10">
                                <label for="Karyakar_MandalId">Mandal</label>
                                @Html.DropDownListFor(t => t.Karyakar.MandalId, Model.Karyakar.Mandals, new { @class = "chzn-select form-control", placeholder = CommonHelper.PlaceHolderDrdForMandal })
                                @Html.ValidationMessageFor(t => t.Karyakar.MandalId)
                            </div>
                            <div class="col-md-4 pt10"></div>
                        </div>

                        <div class="col-md-12 pb10">
                            <div class="col-md-1 pt10 pr0">
                                <input type="submit" value="Save" class="btn btn-success" />
                            </div>
                            <div class="col-md-1 pt10 pl0 pr0"><input type="reset" value="Reset" class="btn btn-info" /></div>
                            <div class="col-md-1 pt10 pl0 pr0">
                                <a href="@Url.RouteUrl("Yagna")">
                                    <input type="button" value="Cancel" class="btn btn-danger" onclick="return confirm('Are you sure want to cancel this request?')" />
                                </a>
                            </div>
                            <div class="col-md-9 pt10"></div>
                        </div>

                    </div>
                </div>
            }

        </div>
    </div>
</div>


@if (Model.ErrorSummary != null && Model.ErrorSummary.Count > 0)
{
    <div class="">
        <div id="errorModel" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">ERROR SUMMARY</h4>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-danger alert-dismissable">
                            <h4><i class="icon fa fa-ban"></i> Alert!</h4>
                            <p>@Model.ErrorMessage</p>
                        </div>

                        @Html.Partial("_ErrorSummary", Model)

                    </div>

                    <div class="modal-footer">
                        @if (Model.ErrorType == RegistrationErrorTypes.Account)
                        {
                            <input type="button" class="btn btn-primary" value="Continue To Save Detail" id="btnContinue" />
                        }
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>


                </div>

            </div>
        </div>
    </div>
}





<script type="text/javascript">

    if (parseInt($("#Id").val()) > 0) {
        $("#AccountDetail_PaidAmount").attr("readonly", "readonly");
        $("#AccountDetail_BookNo").attr("readonly", "readonly");
        $("#AccountDetail_ReceiptNo").attr("readonly", "readonly");
        $("#AccountDetail_DateOfReceipt").attr("readonly", "readonly");

        $("#pnlAccount").css("display", "none");
    }

    $(function () {
        // CalculateSevaAmount();
        $(".chzn-select").chosen();

        var _searchResult = [];
        //CalculateSevaAmount();
        handleTransactionsControl();

        $("#TransactionDetail_DateOfIssue").attr("readonly", "readonly");
        $("#TransactionDetail_DateOfIssue").datepicker({
            format: "MM/dd/yyyy",
            autoclose: true
        });
        $("#AccountDetail_DateOfReceipt").attr("readonly", "readonly");
        $("#AccountDetail_DateOfReceipt").datepicker({
            format: "MM/dd/yyyy",
            autoclose: true
        });

        $("#Yajmans_CityId").change(function () {
            $('#Yajmans_MandalId').empty().trigger('liszt:updated');
            $.get("../../mandal/loadmandalbycity", { cityId: $("#Yajmans_CityId").val() }, function (response) {

                $.each(response.data, function (key, value) {
                    $("#Yajmans_MandalId").append($("<option value='" + value.Value + "'>" + value.Text + "</option>"));
                });
                $('#Yajmans_MandalId').trigger("liszt:updated");
            });
        });


        $("#Karyakar_CityId").change(function () {
            LoadMandals($("#Karyakar_CityId").val(), 0);
        });

        function LoadMandals(city, selectedMandal) {
            $('#Karyakar_MandalId').empty().trigger('liszt:updated');
            $.get("../../mandal/loadmandalbycity", { cityId: city }, function (response) {

                $.each(response.data, function (key, value) {
                    $("#Karyakar_MandalId").append($("<option value='" + value.Value + "'>" + value.Text + "</option>"));
                });
                $('#Karyakar_MandalId').trigger("liszt:updated");
                if (parseInt(selectedMandal) > 0) {

                    $("#Karyakar_MandalId").val(selectedMandal);
                    $("#Karyakar_MandalId").trigger("liszt:updated");
                }
            });
        }

        $("#SankalpAmount").on("keyup", function () {
            var _sankalp = parseInt($("#SankalpAmount").val() == "" ? "0" : $("#SankalpAmount").val());
            var _paid = parseInt($("#AccountDetail_PaidAmount").val() == "" ? "0" : $("#AccountDetail_PaidAmount").val());
            if ((_sankalp - _paid) < 0) {

                $("#AccountDetail_DueAmount").val(0);
            } else {
                $("#AccountDetail_DueAmount").val(_sankalp - _paid);
            }
        });

        $("#SankalpAmount").on("keyup", function () {
            $("#AccountDetail_PaidAmount").val( $("#SankalpAmount").val());
        });

        $("#AccountDetail_PaidAmount").on("keyup", function () {
            CalculateSevaAmount();
        });

        function CalculateSevaAmount() {
            if (parseInt($("#Yajmans_Id").val()) > 0) {
                calculateDueAmount($("#Yajmans_Id").val(), $("#AccountDetail_Id").val(), $("#AccountDetail_PaidAmount").val() == "" ? "0" : $("#AccountDetail_PaidAmount").val());

            }
            else {
                var _sankalp = parseInt($("#SankalpAmount").val() == "" ? "0" : $("#SankalpAmount").val());
                var _paid = parseInt($("#AccountDetail_PaidAmount").val() == "" ? "0" : $("#AccountDetail_PaidAmount").val());
                if ((_sankalp - _paid) < 0) {
                    $("#AccountDetail_PaidAmount").val(_sankalp);
                    $("#AccountDetail_DueAmount").val(0);
                } else {
                    $("#AccountDetail_DueAmount").val(_sankalp - _paid);
                }
            }

        }

        $("#TransactionDetail_TransactionTypeId").on("change", function () {
            handleTransactionsControl();
        });

        function handleTransactionsControl() {

            if (parseInt($("#TransactionDetail_TransactionTypeId").val()) > 1) {
                $("#TransactionDetail_TransactionNumber").removeAttr("disabled", "disabled");
                $("#TransactionDetail_DateOfIssue").removeAttr("disabled", "disabled");
                $("#TransactionDetail_BankName").removeAttr("disabled", "disabled");

                $("#lblTransNo").text($("#TransactionDetail_TransactionTypeId :selected").text() + " Number");
            }
            else {
                $("#lblTransNo").text("Number");
                $("#TransactionDetail_TransactionNumber").val("");
                $("#TransactionDetail_DateOfIssue").val("");
                $("#TransactionDetail_BankName").val("");

                $("#TransactionDetail_TransactionNumber").attr("disabled", "disabled");
                $("#TransactionDetail_DateOfIssue").attr("disabled", "disabled");
                $("#TransactionDetail_BankName").attr("disabled", "disabled");
            }
        }

        $("#Karyakar_Mobile").autocomplete({

            source: function (request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: '/filter/mobile',
                    data: "{'searchTxt':'" + $("#Karyakar_Mobile").val() + "'}",
                    dataType: "json",
                    error: function (result) {
                        alert("Please try again.");
                    },
                    success: function (result) {
                        $(".ui-helper-hidden-accessible").hide();
                        if (result.status == "success") {
                            response($.map(result.data, function (item) {

                                return {
                                    value: item.Mobile,
                                    label: ' ' + item.Mobile + '(' + item.FullName + ')',
                                    firstname: item.FirstName,
                                    middlename: item.MiddleName,
                                    lastname: item.LastName,
                                    id: item.Id,
                                    city: item.CityId,
                                    mandal: item.MandalId
                                }
                            }));
                        }
                    }
                });
            },
            minLength: 10,
            select: function (event, ui) {

                $("#Karyakar_FirstName").val(ui.item.firstname == "New" ? "" : ui.item.firstname);
                $("#Karyakar_MiddleName").val(ui.item.middlename);
                $("#Karyakar_LastName").val(ui.item.lastname);
                $("#Karyakar_Id").val(ui.item.id);
                $("#Karyakar_CityId").val(ui.item.city);
                $("#Karyakar_CityId").trigger("liszt:updated");
                LoadMandals(ui.item.city, ui.item.mandal);

            },
        });

        jQuery.validator.addMethod("SelectedCity", validateDropdownValue, "@CommonHelper.PlaceHolderDrdForCity");
        jQuery.validator.addMethod("SelectedMandal", validateDropdownValue, "@CommonHelper.PlaceHolderDrdForMandal");
        jQuery.validator.addMethod("SelectedGrade", validateDropdownValue, "@CommonHelper.ValMsgDrdForSevaGrade");

        $.validator.setDefaults({ ignore: ":hidden:not(select)" });

        $("#sevaForm").validate({

            rules: {

                'Yajmans.FirstName': { required: true },
                'Yajmans.LastName': { required: true },
                'Yajmans.Mobile': {
                    required: true,
                    minlength: 10,
                    maxlength: 15,
                    number: true
                },
                "Yajmans.CityId": { SelectedCity: '0' },
                "Yajmans.MandalId": { SelectedMandal: '0' },
                'Yajmans.Address': { required: true },
                //'Yajmans.PinCode': { required: true },
                "SevaGradeId": { SelectedGrade: '0' },
                "SankalpAmount": { required: true },

                "AccountDetail.PaidAmount": { required: true },
                "AccountDetail.BookNo": { required: true },
                "AccountDetail.ReceiptNo": { required: true },
                "AccountDetail.DateOfReceipt": { required: true },
                'Karyakar.FirstName': { required: true },
                'Karyakar.LastName': { required: true },
                'Karyakar.Mobile': {
                    required: true,
                    minlength: 10,
                    maxlength: 15,
                    number: true
                },
                "Karyakar.CityId": { SelectedCity: '0' },
                "Karyakar.MandalId": { SelectedMandal: '0' },
                //"SvikrutiPatrakDetail.FormNo": { required: true }
            },
            messages:
                                    {
                                        'Yajmans.FirstName': { required: '@CommonHelper.ValMsgTxtForFirstName' },
                                        'Yajmans.LastName': { required: '@CommonHelper.ValMsgTxtForLastName' },
                                        'Yajmans.Mobile': {
                                            required: '@CommonHelper.ValMsgTxtForMobileNo',
                                            minlength: '@CommonHelper.ValMsgTxtForMobileMinLength',
                                            maxlength: '@CommonHelper.ValMsgTxtForMobileMaxLength'
                                        },
                                        "Yajmans.CityId": {
                                            SelectedCity: '@CommonHelper.ValMsgDrdForCity'
                                        },
                                        "Yajmans.MandalId": {
                                            SelectedMandal: '@CommonHelper.ValMsgDrdForMandal'
                                        },
                                        'Yajmans.Address': { required: '@CommonHelper.ValMsgTxtForAddress' },
                                        @*'Yajmans.PinCode': { required: '@CommonHelper.ValMsgTxtForPinCode' },*@
                                        "SevaGradeId": {
                                            SelectedGrade: '@CommonHelper.ValMsgDrdForSevaGrade'
                                        },

                                        "SankalpAmount": { required: '@CommonHelper.ValMsgTxtForAmount' },
                                        "AccountDetail.PaidAmount": { required: '@CommonHelper.ValMsgTxtForAmount' },
                                        "AccountDetail.BookNo": { required: '@CommonHelper.ValMsgTxtForAccountBookNo' },
                                        "AccountDetail.ReceiptNo": { required: '@CommonHelper.ValMsgTxtForAccountBookReceiptNo' },
                                        "AccountDetail.DateOfReceipt": { required: '@CommonHelper.ValMsgTxtForDateOfReceipt' },
                                        'Karyakar.FirstName': { required: '@CommonHelper.ValMsgTxtForFirstName' },
                                        'Karyakar.LastName': { required: '@CommonHelper.ValMsgTxtForLastName' },
                                        'Karyakar.Mobile': {
                                            required: '@CommonHelper.ValMsgTxtForMobileNo',
                                            minlength: '@CommonHelper.ValMsgTxtForMobileMinLength',
                                            maxlength: '@CommonHelper.ValMsgTxtForMobileMaxLength'
                                        },
                                        "Karyakar.CityId": {
                                            SelectedCity: '@CommonHelper.ValMsgDrdForCity'
                                        },
                                        "Karyakar.MandalId": {
                                            SelectedMandal: '@CommonHelper.ValMsgTxtForMandal'
                                        },

                                        @*"SvikrutiPatrakDetail.FormNo": { required: '@CommonHelper.ValMsgTxtForFormNo' }*@
                                    },
            submitHandler: function (form) {

                if (parseInt($("#AccountDetail_DueAmount").val()) < 0) {
                    $("#SankalpAmount").val(parseInt($("#SankalpAmount").val()) + parseInt($("#AccountDetail_DueAmount").val().replace('-', '')));
                }
                form.submit();
            }
        });


        function validateDropdownValue(value, element, param) {

            if (value == param) {
                return false;
            }
            else {
                return true;
            }
        }

        $("#btnContinue").click(function () {
            $("#IsContinue").val(true);
            $("#sevaForm").submit();

        })
    })

    function calculateDueAmount(yid, id, amount) {

        $.get("../../yagna/getdueamount/", { id: id, yid: yid, amount: amount }, function (response) {

            var dueAmount = parseInt(response.d);

            if (dueAmount == 0) {
                $("#AccountDetail_DueAmount").val($("#SankalpAmount").val());
            }
            else if (dueAmount < 0) {
                $("#AccountDetail_PaidAmount").val(parseInt(amount) + dueAmount);
                $("#AccountDetail_DueAmount").val(0);
            }
            else {
                $("#AccountDetail_DueAmount").val(dueAmount);
            }

        });
    }
</script>
